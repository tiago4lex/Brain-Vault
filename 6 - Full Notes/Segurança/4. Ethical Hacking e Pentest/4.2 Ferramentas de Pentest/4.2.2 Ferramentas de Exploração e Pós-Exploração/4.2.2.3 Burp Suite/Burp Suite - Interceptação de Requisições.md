2025-06-23 18:49

Status: #developed #segurança 

Tags: [[CyberSecurity]] | [[Ferramentas]] | [[Burp Suite]]

----
# O que é Interceptação de Requisições?

A interceptação de requisições (ou *HTTP Request Interception*) é a técnica de **capturar, analisar e modificar** requisições HTTP/HTTPS entre um cliente (navegador, app) e um servidor. É usada para:

- Testes de segurança *(pentesting)*.
- Debug de aplicações web.
- Análise de APIs.

---
# Como Funciona?

1. **Proxy Interceptador:** Ferramentas como Burp Suite atuam como intermediários entre o cliente e o servidor.
2. **SSL Decryption:** Permite ler tráfego HTTPS (via certificados locais).
3. **Modificação em Tempo Real:** Altere parâmetros, headers ou cookies antes de chegarem ao servidor.

---
# Ferramentas para Interceptação

| **Ferramenta** | **Descrição**                                           |
| -------------- | ------------------------------------------------------- |
| Burp Suite     | Proxy avançado para *pentesting* (*Community* e *Pro*). |
| OWASP ZAP      | Alternativa open-source ao Burp.                        |
| Fiddler        | Focado em desenvolderores (Windows).                    |
| mitmproxy      | Proxy em terminal para Linux/macOS.                     |

---
# Exemplo Prático: Interceptação com Burp Suite

## Passo 1: Iniciando a ferramenta

Em `Proxy > Intercept`, deixe o terceiro botão em `Intercept is off` e clique em `Open Browser` para abrir um navegador Chromium com o proxy configurado:

![[Pasted image 20250623213035.png]]

## Passo 2: Interceptando um requisição

Acessando o site (ex: `http://testphp.vulnweb.com`) depois selecionando o terceiro botão para `Intercept is on` para ele interceptar a requisição:

![alt text: Screenshot da tela “Proxy>Intercept” do Burp Suite, onde se têm em destaque com uma caixa e uma seta em vermelho: o terceiro botão em azul chamado “Intercept is on”.](https://cdn3.gnarususercontent.com.br/2518-cyberseguranca/01/30.png)

No Burp, a requisição GET aparecerá:

```http
GET /login.php HTTP/1.1
Host: testphp.vulnweb.com
User-Agent: Mozilla/5.0
```

Através da ferramenta é possível fazer alterações da requisição, nesta requisição é possível alterar de `GET` para `POST` e adicionar os seguintes parâmetros:

```http
POST /login.php HTTP/1.1
Host: testphp.vulnweb.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 29

uname=admin&pass=password123
```

Clique em **Forward** para enviar ao servidor.

![[Pasted image 20250623213606.png]]

## Passo 3: Analisando a resposta

- A resposta interceptada pode revelar:    
    - Tokens de sessão.
    - Vulnerabilidades (SQLi, XSS).

---
# Técnicas Avançadas

## A) *Bypass* de Autenticação

- Modificação de cookies (ex: `admin=true`).
- Adicionar headers como `X-Fowarded-For: 127.0.0.1`.

![alt text: Tela “Proxy > Intercept” do Burp Suite, onde se tem um texto que descrevem uma requisição do tipo POST na página https://ac7e1f701ef1de35c0f0a65f002b001b.web-security-academy.net, tendo em destaque por uma caixa em vermelho, o primeiro botão chamado “Forward” localizado após os cabeçalhos, bem como a linha 3 com o seguinte texto: “Cookie: Admin=true;”](https://cdn3.gnarususercontent.com.br/2518-cyberseguranca/01/33.png)

## B) Exploração de APIs

- Interceptar chamadas REST (ex: `POST /api/users`).
- Teste de inseguranças (ex: IDOR trocando `user_id=123` para `user_id=124`).

---
# Mitigação Contra Interceptação

- **HHTPS com HSTS:** Evita downgrade para HTTP
- ***Certificate Pinning:*** Apps móveis bloqueiam certificados não autorizados
- **Headers de Segurança:**

```http
Strict-Transport-Security: max-age=31536000
Content-Security-Policy: default-src 'self'
```

---
# Conclusão

A interceptação de requisições é essencial para *pentesters* e desenvolvedores. Com Burp Suite é possível:

- Identificar vulnerabilidades
- Testar lógicas de negócio
- Debuggar APIs