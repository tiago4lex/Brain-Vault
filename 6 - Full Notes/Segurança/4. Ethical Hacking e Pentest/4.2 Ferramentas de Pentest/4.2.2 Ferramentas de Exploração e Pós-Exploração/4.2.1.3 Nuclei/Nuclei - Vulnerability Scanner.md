2025-08-25 12:52

Status: #developed #segurança 

Tags: [[CyberSecurity]] | [[Nuclei]] | [[Pentest]] | [[Ferramentas]]

----
# Introdução

## O que é o Nuclei?

**Nuclei** é uma ferramenta de escaneamento de vulnerabilidades rápida e personalizável, desenvolvida pela ***ProjectDiscovery***. Ela utiliza modelos baseados em YAML para detectar vulnerabilidades, desconfigurações e exposição de dados sensíveis em sistemas.

![[Pasted image 20250825125852.png]]

## Características Principais

- Escaneamento rápido e baseado em templates.
- Suporte para múltiplos protocolos (HTTP, TCP, DNS, SSL, etc.).
- Comunidade ativa com milhares de templates.
- Integração com outras ferramentas (Subfinder, Amass, etc.).
- Saída formatada em JSON, CSV, Markdown.

---
# Como o Nuclei Funciona?

O Nuclei funciona através de **templates YAML** que definem:

- **Requests:** O que enviar para o alvo.
- **Conditions:** Como processar respostas.
- **Metadata:** Informações sobre a vulnerabilidade.

## Fluxo de funcionamento

1. Recebe lista de alvos (URLs, hosts, IPs).
2. Carrega template selecionados.
3. Envia requests personalizados.
4. Analisa respostas baseado nas condições.
5. Reporta vulnerabilidades encontradas.

---
# Instalação do Nuclei

## Instalação no Linux

```bash
# Instalação via Go
go install -v github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest

# Instalação via pacote (Linux)
sudo apt update && sudo apt install nuclei

# Atualização de templates
nuclei -update-templates
```

## Instalação no Docker

```bash
docker pull projectdiscovery/nuclei:latest
docker run -it projectdiscovery/nuclei -u https://example.com
```

---
# Sintaxe Básica de Uso

```bash
nuclei -u <URL> -t <TEMPLATE>
nuclei -l <LISTA_ALVOS> -t <TEMPLATE>
```

---
# Exemplos Práticos de Uso

## 1. Escaneamento Básico em um Alvo

```bash
nuclei -u https://example.com
```

## 2. Usando Templates Específicos

```bash
# Scan para vulnerabilidades críticas
nuclei -u https://example.com -t cves/

# Scan para misconfigurações
nuclei -u https://example.com -t misconfiguration/

# Scan para tecnologias específicas
nuclei -u https://example.com -t technologies/
```

## 3. Escaneamento em Lote

```bash
# De uma lista de URLs
nuclei -l urls.txt -o results.txt

# Combinando com outras ferramentas
subfinder -d example.com | nuclei -t cves/ -o results.txt
```

## 4. Filtros por Severidade

```bash
# Apenas vulnerabilidades críticas e altas
nuclei -u https://example.com -severity critical,high
```

## 5. Templates Personalizados

```bash
# Usar template customizado
nuclei -u https://example.com -t /path/to/custom-template.yaml

# Criar seus próprios templates
nuclei -ut # Atualiza todos os templates
```

---
# Tipos de Templates Disponíveis

### **Categorias Principais:**

- **cves/**: Vulnerabilidades conhecidas (CVE)
- **misconfiguration/**: Configurações inadequadas
- **technologies/**: Detecção de tecnologias
- **exposures/**: Dados expostos
- **file/**: Arquivos sensíveis
- **workflows/**: Fluxos de escaneamento complexos

---
# Exemplos de Comandos Avançados

## Acesso com Autenticação

```bash
nuclei -u https://example.com -H "Authorization: Bearer TOKEN"
```

## Rate Limiting

```bash
nuclei -l targets.txt -rate-limite 100 # 100 requestes/segundo
```

## Proxy Configuration

```bash
nuclei -u https://example.com -proxy http:127.0.0.1:8080
```

## Output Formats

```bash
nuclei -u https://example.com -o results.json -json
nuclei -u https://example.com -o results.md -markdown
```

---
# Integração com Outras Ferramentas

## Com `subfinder` para Subdomínios

```bash
subfinder -d example.com | nuclei -t cves/ -o results.txt
```

## Com `naabu` para Port Scanning

```bash
nabuu -list hosts.txt | nuclei -t exposures/ -o results.txt
```

## Com `waybackurls` para URLs

```bash
waybackurls example.com | nuclei -t exposures/ -o results.txt
```

---
# Criando Templates Customizados

## Estrutura Básica de Templates

```yaml
id: example-vuln

info:
  name: Example Vulnerability
  author: your-name
  severity: high
  description: |
    This is a sample template for demonstration.

requests:
  - method: GET
    path:
      - "{{BaseURL}}/vulnerable-endpoint"

    matchers:
      - type: word
        words:
          - "vulnerable string found"
```

## Template com Múltiplos Requests

```yaml
id: complex-check

requests:
  - method: GET
    path:
      - "{{BaseURL}}/login"

  - method: POST
    path:
      - "{{BaseURL}}/login"
    body: "username=admin&password=admin"
    matchers:
      - type: word
        words:
          - "Dashboard"
```

---
# Workflows Avançados

## Exemplo de Workflow

```yaml
id: comprehensive-scan

info:
  name: Comprehensive Scan Workflow
  author: nuclei-community

workflows:
  - template: cves/
  - template: misconfiguration/
  - template: exposures/
  - template: technologies/
```

## Executando Workflow

```bash
nuclei -u https://example.com -w comprehensive-scan.yaml
```

---
# Dicas e Boas Práticas

## Otimização de Performance

```bash
# Limitar concorrência
nuclei -l targets.txt -c 50

# Timeouts personalizados
nuclei -l targets.txt -timeout 5

# Templates otimizados
nuclei -l targets.txt -t cves/ -es info
```

## Gestão de Templates

```bash
# Listar templates instalados
nuclei -tl

# Validar templates
nuclei -validate

# Remover templates desatualizados
nuclei -ut
```

---
# Exemplos de Saída

## Saída Padrão

```text
[INF] [CVE-2021-44228] Log4j RCE (https://example.com/api)
[INF] [exposed-panel] Admin Panel Exposed (https://example.com/admin)
[HIGH] [misconfig-headers] Missing Security Headers (https://example.com)
```

## Saída JSON

```json
{
  "template": "CVE-2021-44228",
  "host": "https://example.com",
  "matched": "/api",
  "severity": "CRITICAL"
}
```

---
# Considerações de Segurança

### Ethical Hacking:

- Sempre obtenha permissão antes de escanear
- Use em ambientes controlados para testes
- Respeite rate limits e termos de serviço

## Configurações Seguras

```bash
# Não seguir redirecionamentos
nuclei -u https://example.com -no-redirects

# Validar certificados SSL
nuclei -u https://example.com -verify-ssl
```

---
# Conclusão

O Nuclei é uma ferramenta poderosa para:  
✅ **Detecção rápida de vulnerabilidades**  
✅ **Escaneamento em grande escala**  
✅ **Automação de testes de segurança**  
✅ **Integração com outras ferramentas**

---
# Referências

- [Documentação Oficial](https://nuclei.projectdiscovery.io/)
- [Repositório de Templates](https://github.com/projectdiscovery/nuclei-templates)
- [Community Discord](https://discord.gg/projectdiscovery)