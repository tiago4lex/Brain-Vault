2025-08-25 13:16

Status: #developed #segurança 

Tags: [[CyberSecurity]] | [[Nuclei]]

----
# Estrutura dos Templates do Nuclei

Os Templates do Nuclei são arquivos YAML que definem como a ferramenta deve detectar vulnerabilidades, misconfigurações ou informações. A estrutura básica inclui:

```yaml
id: template-id

info:
  name: Template Name
  author: Author Name
  severity: low|medium|high|critical
  description: Description of what the template detects
  reference: # Optional references
    - https://example.com
  tags: cve,wordpress,rce # Categorias

variables: # Variáveis opcionais
  admin_path: "admin"

requests:
  - method: GET
    path:
      - "{{BaseURL}}/{{admin_path}}"
    matchers:
      - type: word
        words:
          - "Admin Panel"
        condition: and
```

---
# Como explorar os Templates Disponíveis

## Listar Todos os Templates

```bash
nuclei -tl
```

## Listar Templates por Categoria

```bash
nuclei -tl -tc cves
nuclei -tl -tc misconfiguration
nuclei -tl -tc technologies
nuclei -tl -tc exposures
nuclei -tl -tc file
```

## Buscar Templates por Palavra-Chave

```bash
nuclei -tl -tags wordpress
nuclei -tl -tags rce
nuclei -tl -tags xss
```

## Ver Detalhes de um Template Específico

```bash
nuclei -td -id git-config-exposure
```

## Ver Estatísticas dos Templates

```bash
nuclei -ts
```

---
# Como saber qual Template USAR?

## a) Por Tipo de Alvo

| **Tipo de Alvo**      | **Categorias Recomendadas**                |
| --------------------- | ------------------------------------------ |
| Web Application       | `cves/`, `exposures/`, `misconfiguration/` |
| Network Device        | `network/`, `cves/`                        |
| API                   | `cves/`, `misconfiguration/`               |
| Tecnologia Específica | `technologies/` + nome da tecnologia       |

## b) Por Objetivo de Teste

| **Objetivo**              | **Tags/Categorias**       |
| ------------------------- | ------------------------- |
| Vulnerabilidades Críticas | `-severity critical,high` |
| Dados Expostos            | `exposures/`, `file/`     |
| Misconfigurações          | `misconfiguration/`       |
| Reconhecimento            | `technologies`            |

## c) Por Tecnologia Detectada

```bash
# WordPress
nuclei -tl -tags wordpress

# Joomla
nuclei -tl -tags joomla

# Apache
nuclei -tl -tags apache

# Kubernetes
nuclei -tl -tags kubernetes
```

---
# Exemplos Práticos de Seleção de Templates

## Cenário 1: Scan Inicial Rápido

```bash
# Apenas vulnerabilidades críticas e altas
nuclei -u https://target.com -severity critical,high -es info

# Mais completo mas ainda rápido
nuclei -u https://target.com -t cves/,exposures/ -es info
```

## Cenário 2: Scan Completo em WordPress

```bash
# Todos os templates para WordPress
nuclei -u https://target.com -tags wordpress

# Combinando categorias
nuclei -u https://target.com -t cves/ -tags wordpress -severity medium,high,critical
```

## Cenário 3: Busca por Dados Sensíveis

```bash
# Arquivos de configuração expostos
nuclei -u https://target.com -t exposures/

# Arquivos sensíveis específicos
nuclei -u https://target.com -t file/
```

## Cenário 4: Scan em API

```bash
# Vulnerabilidades em APIs
nuclei -u https://target.com/api -t cves/ -tags api

# Misconfigurações comuns
nuclei -u https://target.com -t misconfiguration/ -tags api
```

---
# Como analisar um Template antes de Usar

## Inspecionar Template

```bash
nuclei -td -id exposed-panel

# Ou visualizar o arquivo diretamente
find ~/nuclei-templates -name "*exposed-panel*" -exec cat {} \;
```

### Componentes Chave para Analisar

1. **Severity**: Qual a criticidade?
2. **HTTP Method**: GET, POST, etc.
3. **Matchers**: O que procura nas respostas?
4. **Extractors**: Que dados extrai?
5. **Conditions**: Condições complexas?

## Exemplo de Análise

```yaml
# Template: git-config-exposure
matchers:
  - type: word
    words:
      - "[core]"
      - "repositoryformatversion"
    condition: and
# Procura por arquivos .git/config com conteúdo específico
```

---
# Filtros Avançados na Linha de Comando

## Por Autor

```bash
nuclei -tl -author pdteam
```

## Por Severidade

```bash
nuclei -tl -severity critical
```

## Por Complexidade

```bash
nuclei -tl -tc advanced
```

## Múltiplos Filtros

```bash
nuclei -tl -tags wordpress -severity high -author geeknik
```

---
# Workflows para Diferentes Situações

## Workflow para Scan Web Básico:

```yaml
id: web-basic-scan
info:
  name: Basic Web Application Scan
  author: security-team

workflows:
  - template: cves/
  - template: exposures/
  - template: misconfiguration/
```

## Workflow para WordPress

```yaml
id: wordpress-scan
info:
  name: WordPress Comprehensive Scan
  author: security-team

workflows:
  - template: technologies/wordpress-detect.yaml
  - tags: wordpress
    severity: medium,high,critical
```

## Executar Workflow

```bash
nuclei -u https://target.com -w wordpress-scan.yaml
```

---
# Dicas para Escolha Inteligente de Templates

## Para Pentesting

```bash
# Foco em RCE e vulnerabilidades críticas
nuclei -u https://target.com -tags rce -severity critical

# Adicionar authentication bypass
nuclei -u https://target.com -tags auth-bypass
```

## Para Bug Bounty

```bash
# Começar com baixo ruído
nuclei -u https://target.com -t exposures/ -es info

# Escalar gradualmente
nuclei -u https://target.com -severity high,critical -rate-limit 50
```

## Para Asset Discovery

```bash
# Descobrir tecnologias
nuclei -u https://target.com -t technologies/

# Encontrar painéis administrativos
nuclei -u https://target.com -tags panel
```

---
# Gerenciamento de Templates

## Atualização Diária

```bash
nuclei -update-templates

# Verificar templates novos
nuclei -tl -new
```

## Backup de Templates

```bash
# Backup da pasta de templates
cp -r ~/nuclei-templates ./backup-nuclei-templates-$(date +%Y%m%d)
```

## Templates Personalizados

```bash
# Criar pasta para templates customizados
mkdir -p ~/nuclei-custom-templates

# Usar templates customizados
nuclei -u https://target.com -t ~/nuclei-custom-templates/
```

---
# Exemplo de Fluxo de Trabalho Completo

## Passo 1: Reconhecimento

```bash
nuclei -u https://target.com -t technologies/ -silent
```

## Passo 2: Scan Focado

```bash
# Baseado nas tecnologias encontradas
nuclei -u https://target.com -tags wordpress,apache -severity medium,high,critical
```

## Passo 3: Busca por Dados Sensíveis

```bash
nuclei -u https://target.com -t exposures/,file/ -silent
```

## Passo 4: Verificação de Vulnerabilidades

```bash
nuclei -u https://target.com -t cves/ -severity high,critical
```

---
# Conclusão

## Melhores Práticas

1. **Comece com templates de tecnologia** para reconhecimento
2. **Use severity filtering** para evitar ruído
3. **Combine com outras ferramentas** para melhor cobertura
4. **Mantenha templates atualizados** diariamente
5. **Use rate limiting** para evitar bloqueios

## Comando de Referência Rápida

```bash
# Scan inteligente inicial
nuclei -u https://target.com -t technologies/ -silent
nuclei -u https://target.com -tags $(tech-encontrada) -severity high,critical -rate-limit 100
```