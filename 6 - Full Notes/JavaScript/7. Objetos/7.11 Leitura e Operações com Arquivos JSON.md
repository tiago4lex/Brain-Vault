2025-11-10 10:50

Status: #developed #javascript 

Tags: [[JavaScript]] | [[JSON]]

----
# Introdução

O **JSON** *(JavaScript Object Notation)* é um formato leve e amplamente utilizado para armazenar e trocar dados entre aplicações.

Além de manipular JSON diretamente no código, também é muito comum **ler, gravar e modificar arquivos JSON** armazenados em disco — especialmente em **projetos Node.js**, onde o JavaScript é executado fora do navegador.

---
# Conceito: O que é um Arquivo JSON?

Um **arquivo JSON** é um arquivo de texto que contém dados estruturados no formato JSON, geralmente com a extensão `.json`.

**Exemplo: arquivo `dados.json`**

```json
{
  "nome": "Maria",
  "idade": 23,
  "habilidades": ["JavaScript", "Python", "Cibersegurança"]
}
```

> Esse arquivo pode ser lido e interpretado por diversas linguagens, inclusive JavaScript.

---
# Leitura do JSON no Navegador (frontend)

Quando o arquivo JSON está hospedado em um servidor (ou no mesmo projeto), é possível **acessá-lo usando `fetch()`**, que lê o conteúdo do arquivo e o converte para objeto JavaScript.

## Exemplo

```js
fetch("dados.json")
	.then(response => response.json()) // Converte o texto JSON em objeto jS
	.then(dados => {
		console.log(dados.nome); // Acessa a propriedade "nome"
		console.log(dados.habilidades[1]); // Acessa "Python"
	})
	.catch(error => console.error("Erro ao ler JSON:", error));
```

**Explicação:**

1. `fetch("dados.json")` → faz requisição HTTP para o arquivo.
2. `response.json()` → converte o texto JSON em objeto JavaScript.
3. O objeto é retornado na função `.then()`, pronto para ser manipulado.

---
# Leitura de Arquivos JSON no Node.js

Em ambientes **Node.js**, a leitura de arquivos JSON é feita pelo módulo interno `fs` *(file system)*, que permite interagir com o sistema de arquivos.

Existem duas abordagens princiapais:

## 1. Leitura Síncrona (`fs.readFileSync`)

Essa abordagem **bloqueia a execução até que o arquivo seja lido** — ideal para scripts simples.

**Exemplo:**

```js
const fs = require('fs');

// Lê o conteúdo do arquivo (como texto)
const dadosBrutos = fs.readFileSync('dados.json', 'utf-8');

// Converte o texxto JSON em objeto JavaScript
const dados = JSON.parse(dadosBrutos);

console.log(dados.nome); // Maria
console.log(dados.habilidades); // ["JavaScript", "Python", "Cibersegurança"]
```

**Explicação:**

- `fs.readFileSync()` → lê o arquivo e retorna uma string.
- `JSON.parse()` → converte string JSON em objeto.

## 2. Leitura Assíncrona (`fs.readFile`)

Essa forma **não bloqueia a execução do programa** — mais recomendada em aplicações reais.

**Exemplo:**

```js
const fs = require('fs');

fs.readFile('dados.json', 'utf-8', (erro, dadosBrutos) => {
	if (erro) {
		console.error("Erro ao ler arquivo JSON:", erro);
		return;
	}
	
	const dados = JSON.parse(dadosBrutos);
	console.log(dados.nome); // Maria
});
```

**Explicação:**

- A leitura ocorre em **background**.
- Quando termina, o callback é chamado com o conteúdo.
- `JSON.parse()` é usado para transformar o texto em objeto JS.

---
# Escrevendo (Criando ou Atualizando) Arquivos JSON

Para **gravar dados** em um arquivo JSON, usamos o inverso do processo:

1. Converter o objeto JavaScript em string JSON com `JSON.stringify()`.
2. Escrever a string em um arquivo usando o `fs`.

## Exemplo 1: Criar um novo arquivo JSON

```js
const fs = require('fs');

const usuario = {
	nome: "Maria",
	idade: 23,
	area: "Cibersegurança"
};

// Converte o objeto em texto JSON formatado
const jsonString = JSON.stringify(usuario, null, 2);

// Salva no arquivo
fs.writeFileSync('usuario.json', jsonString, 'utf-8');

console.log("Arquivo JSON criado com sucesso!");
```

**Explicação:**

- `JSON.stringify(objeto, null, 2)` → converte o objeto em texto, com indentação de 2 espaços.
- `fs.writeFileSync()` → cria ou sobrescreve o arquivo com o conteúdo JSON.


## Exemplo 2: Atualizar um arquivo JSON existente

```js
const fs = require('fs');

const dadosBrutos = fs.readFileSync('usuario.json', 'utf-8');
const usuario = JSON.parse(dadosBrutos);

// Modifica o objeto
usuario.habilidades = ["JavaScript", "Python", "Node.js"];

// Reescreve o arquivo com os dados atualizados
fs.writeFileSync('usuario.json', JSON.stringify(usuario, null, 2));

console.log("Arquivo atualizado com sucesso!");
```

---
# Removendo ou Limpando Dados de um Arquivo JSON

É possível **deletar o arquivo inteiro** ou **remover apenas propriedades** de dentro do onbjeto.

## Remover o arquivo

```js
const fs = require('fs');

fs.unlinkSync('usuario.json');
console.log("Arquivo deletado com sucesso!");
```

## Remover uma propriedade do JSON

```js
delete usuario.area;
fs.writeFileSync('usuario.json', JSON.stringify(usuario, null, 2));
```

---
# Manipulando Arrays em Arquivos JSON

Os arquivos JSON frequentemente armazenam **listas de objetos** (arrays).
É possível adicionar, remover ou modificar itens dentro dessas listas.

## Exemplo: Adicionar um novo item em uma lista

**Arquivo `produtos.json`:**

```json
[
  { "id": 1, "nome": "Notebook", "preco": 3500 },
  { "id": 2, "nome": "Mouse", "preco": 80 }
]
```

**Código JavaScript:**

```js
const fs = require('fs');

const dados = JSON.parse(fs.readFileSync('produtos.json', 'utf-8'));

// Adiciona um novo produto
dados.push({ id: 3, nome: "Teclado", preco: 120 });

// Salva novamente
fs.writeFileSync('produtos.json', JSON.stringify(dados, null, 2));

console.log("Produto adicionado!");
```

---
# JSON Dinâmico em APIs (Exemplo Completo)

É possível também **ler e escrever JSON dinamicamente em um servidor Node.js** com Express.

## Exemplo

```js
const express = require('express');
const fs = require('fs');
const app = express();

app.use(express.json());

// Lê todos os usuários
app.get('/usuarios', (req, res) => {
  const dados = JSON.parse(fs.readFileSync('usuarios.json', 'utf-8'));
  res.json(dados);
});

// Adiciona novo usuário
app.post('/usuarios', (req, res) => {
  const dados = JSON.parse(fs.readFileSync('usuarios.json', 'utf-8'));
  dados.push(req.body);
  fs.writeFileSync('usuarios.json', JSON.stringify(dados, null, 2));
  res.send("Usuário adicionado com sucesso!");
});

app.listen(3000, () => console.log("Servidor rodando na porta 3000"));
```

**Nesse exemplo:**

- `/usuarios` → retorna os dados do arquivo JSON.
- `POST /usuarios` → adiciona novos registros.

---
# Resumo

|Operação|Função|Descrição|
|---|---|---|
|**Ler (síncrono)**|`fs.readFileSync()`|Lê o arquivo JSON (bloqueante)|
|**Ler (assíncrono)**|`fs.readFile()`|Lê o arquivo sem bloquear|
|**Converter para Objeto**|`JSON.parse()`|Transforma texto JSON em objeto|
|**Converter para Texto**|`JSON.stringify()`|Transforma objeto em texto JSON|
|**Gravar**|`fs.writeFileSync()`|Cria ou sobrescreve arquivo|
|**Deletar**|`fs.unlinkSync()`|Remove o arquivo JSON|

---
# Dicas Importantes

✅ Sempre use `try...catch` para capturar erros ao ler ou gravar JSON.  
✅ Use `JSON.stringify(objeto, null, 2)` para gerar arquivos legíveis.  
✅ Nunca edite manualmente arquivos JSON com vírgulas extras — isso os torna inválidos.  
✅ Em aplicações grandes, prefira operações assíncronas (`fs.promises` ou `await`).

---
# Conclusão

O domínio sobre **leitura e operações com JSON** é essencial para qualquer desenvolvedor JavaScript — seja no **frontend**, manipulando dados vindos de APIs, ou no **backend**, salvando e carregando arquivos de configuração ou persistência simples.

O formato JSON é a base da **comunicação entre sistemas modernos**, e saber como manipulá-lo de forma segura e eficiente é uma **habilidade fundamental em Engenharia de Software e Cibersegurança**.