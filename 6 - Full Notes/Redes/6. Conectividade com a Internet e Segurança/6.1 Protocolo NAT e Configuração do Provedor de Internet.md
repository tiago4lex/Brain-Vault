2025-07-01 06:34

Status: #developed #redes 

Tags: [[Redes de Computadores]] | [[NAT]] | [[Endere√ßamento]] | [[Cisco]] | [[Camada 3 - Rede]] | [[Internet]]

----
# Introdu√ß√£o

## üåê Oque √© NAT?

**NAT *(Network Address Translation)*** √© um protocolo que permite que v√°rios dispositivos em uma **rede local com IPs privados** acessem a Internet usando **um √∫nico IP p√∫blico**.

## üéØ Para que serve o NAT?

- Permite que redes privadas (LAN) acessem a Internet.
- Economiza endere√ßos IPv4 p√∫blicos.
- Atua como **uma camada de seguran√ßa**, ocultando a estrutura interna da rede.
- √â fundamental para a comunica√ß√£o entre a **rede local** e a **rede do provedor ISP**

## üîí Faixas de IPs privados (RFC 1918)

Esses IPs **n√£o s√£o rote√°veis na internet** e requerem NAT para se comunicarem externamente:

- **Classe A:** `10.0.0.0` - `10.255.255.255`
- **Classe B:** `172.16.0.0` - `172.31.255.255`
- **Classe C:** `192.168.0.0` - `192.168.255.255`

---
# üß† Como funciona o NAT?

Imagine que um PC com IP privado `192.168.1.10` queira acessar `google.com`. Ele envia a requisi√ß√£o para o roteador que tem:

- Um IP interno (para a rede LAN)
- Um IP externo (p√∫blico)

O roteador:

1. Substitui o IP de origem (`192.168.1.10`) por seu IP p√∫blico (ex: `200.1.1.1`)
2. Encaminha o pacote para a internet.
3. Quando a resposta chega, ele consulta a **tabela NAT** e redireciona o tr√°fego de volta para `192.168.1.10`.

O roteador NAT **traduz**:

| **Origem (LAN)**  | **Destino (Internet)** |
| ----------------- | ---------------------- |
| 192.168.1.10:1234 | ‚Üí 200.1.1.5:1234       |
| 196.168.1.11:1235 | ‚Üí 200.1.1.5:1235       |
Ou seja, **substitui os IPs privados por um IP p√∫blico** configurado na interface de sa√≠da.

![[Pasted image 20250701064324.png]]

---
# üì¶ Tipos de NAT

| **Tipo**             | **Descri√ß√£o**                                                                 |
| -------------------- | ----------------------------------------------------------------------------- |
| *Static NAT*         | Um IP privado √© mapeado para um √∫nico IP p√∫blico                              |
| *Dynamic NAT*        | Um grupo de IPs p√∫blicos √© usado para mapear IPs privados conforme necess√°rio |
| *PAT (NAT Overload)* | V√°rios IPs privados usam **um √∫nico IP p√∫blico**, diferenciando por portas.   |
> O tipo  mais comum e usado em redes dom√©sticas e empresas √© o **PAT**

---
# üõ†Ô∏è Exemplo pr√°tico 1

## Objetivo

Fazer com que os PCs da rede LAN (privada) consigam acessar a Internet por meio de um **roteador com NAT** e um **roteador do provedor (ISP)**

## 1. Topologia sugerida

```css
[PC0] --\
         \
        [Switch] -- [Router0] ------ [RouterISP] -------- [Servidor]
        LAN 192.168.1.0/24     NAT   WAN 200.1.1.0/30      Ex: 8.8.8.8

```

## 2. Configura√ß√£o do **Router0 (cliente)**

```bash
enable
configure terminal

! Interface interna (LAN)
interface gigabitEthernet0/0
ip address 192.168.1.1 255.255.255.0
ip nat inside
no shutdown
exit

! Interface externa (WAN)
interface gigabitEthernet0/1
ip address 200.1.1.2 255.255.255.252
ip nat outside
no shutdown
exit

! Acesso √† Internet usando NAT Overload (PAT)
access-list 1 permit 192.168.1.0 0.0.0.255

ip nat inside source list 1 interface gigabitEthernet0/1 overload

! Rota padr√£o para o ISP
ip route 0.0.0.0 0.0.0.0 200.1.1.1

exit
```

## 3. Configura√ß√£o do **RouterISP**

```bash
enable
configure terminal

interface gigabitEthernet0/0
ip address 200.1.1.1 255.255.255.252
no shutdown
exit

! Rota para rede interna
ip route 192.168.1.0 255.255.255.0 200.1.1.2
exit
```

## 4. Configura√ß√£o do PC

Em **Desktop > IP Configuration**:

- IP: `192.168.1.10`
- Subnet mask: `255.255.255.0`
- Gateway: `192.168.1.1`
- DNS: pode usar `8.8.8.8` ou um servidor na topologia

## 5. Teste de conectividade

No PC:

```bash
ping 8.8.8.8      ‚Üê Testa conectividade com o "mundo externo"
```

---
# Exemplo 2

## üåê Cen√°rio

- Rede interna: `192.168.10.0/24`
- IP p√∫blico: `200.1.1.2`
- Interface interna: `FastEthernet0/0`
- Interface externa: `Serial0/0/0`

## Passo a Passo

```bash
Router> enable
Router# configure terminal

! Defina quais interfaces s√£o internas e externas:
Router(config)# interface fastEthernet0/0
Router(config-if)# ip nat inside
Router(config-if)# exit

Router(config)# interface serial0/0/0
Router(config-if)# ip nat outside
Router(config-if)# exit

! Crie uma lista de acesso para identificar os IPs privados
Router(config)# access-list 1 permit 192.168.10.0 0.0.0.255

! Configure o NAT com overload (PAT)
Router(config)# ip nat inside source list 1 interface serial0/0/0 overload

Router(config)# exit
Router# write memory
```

## ‚úÖ O que essa configura√ß√£o faz?

- Marca as interfaces como **dentro** (inside) e **fora** (outside).
- Permite que a rede `192.168.10.0/24` use o IP da interface externa (p√∫blica) para navegar.
- **Overload** permite m√∫ltiplos dispositivos usando o mesmo IP p√∫blico com portas diferentes.

---
# Como o NAT se relaciona com o provedor?

O **ISP *(Internet Service Provider)*** atribuiu ao seu roteador um **IP p√∫blico**. Este IP √© usado no NAT para permitir que sua rede interna:

- Acesse sites da internet
- Realize download/upload
- Se comunique com servidores externos

Sem NAT, os IPs privados **n√£o poderiam sair da rede local**, pois **n√£o s√£o rote√°veis na Internet**.

---
# üîç Verificando NAT

Use no roteador cliente:

```bash
show ip nat translations         ‚Üê Mostra as tradu√ß√µes feitas
show ip nat statistics           ‚Üê Mostra estat√≠sticas de uso
```

---
# üìà Vantagens do NAT

- **Economia de IPv4**
- **Seguran√ßa b√°sica** (n√£o revela IPs internos)
- **Flexibilidade** para alterar IPs internos sem afetar a internet

---
# ‚ö†Ô∏è Limita√ß√µes

- Pode **quebrar protocolos que dependem de endere√ßos IP embutidos** no payload (ex: VoIP, FTP passivo).
- **N√£o adiciona criptografia** (n√£o √© como VPN).
- Em redes grandes, pode ser necess√°rio controle mais avan√ßado (ex: firewalls com NAT din√¢mico e regras espec√≠ficas).

---
# ‚úÖ Conclus√£o

O **NAT** √© um protocolo essencial em redes modernas. Ele permite que redes privadas com IPs reservados se comuniquem com a internet p√∫blica usando um IP fornecido pelo provedor. No Cisco Packet tracer, o NAT √© configurado no roteador do cliente, enquanto o **roteador ISP** simula o papel do provedor.